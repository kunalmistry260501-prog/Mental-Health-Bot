<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mental Health Screening Assistant</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(-45deg, #f3f4f6, #e0f2fe, #fce7f3, #dcfce7);
    background-size: 400% 400%;
    animation: gradientBG 20s ease infinite;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}
@keyframes gradientBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.container {
    width: 420px;
    height: 680px;
    background: #ffffff;
    border-radius: 25px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    position: relative;
}

.header {
    padding: 15px;
    text-align: center;
    font-weight: bold;
    font-size: 18px;
    background: #f8fafc;
    border-bottom: 1px solid #ddd;
}

.chat {
    flex: 1;
    padding: 15px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.message {
    max-width: 75%;
    padding: 12px 16px;
    border-radius: 18px;
    margin-bottom: 10px;
}
.bot { background: #f1f5f9; align-self: flex-start; }
.user { background: #dcfce7; align-self: flex-end; }

.options {
    padding: 12px;
    background: #f8fafc;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    border-top: 1px solid #ddd;
}
.options button {
    margin: 5px;
    padding: 8px 12px;
    border-radius: 20px;
    border: none;
    background: #22c55e;
    cursor: pointer;
    font-weight: 600;
}
.options button:hover { background: #16a34a; }

input {
    padding: 8px;
    width: 80%;
    margin-top: 10px;
}

.result-screen {
    position: absolute;
    inset: 0;
    background: white;
    padding: 25px;
    text-align: center;
    display: none;
}

.score {
    font-size: 45px;
    font-weight: bold;
    margin: 10px 0;
}

.risk-label {
    font-weight: bold;
    margin-bottom: 10px;
}

.btn {
    margin-top: 15px;
    padding: 10px 18px;
    border-radius: 20px;
    border: none;
    font-weight: bold;
    cursor: pointer;
}
.download { background: #2563eb; color: white; }
.restart { background: #fbbf24; }
</style>
</head>

<body>

<div class="container">
<div class="header">ðŸ§  Mental Health Screening Assistant</div>
<div class="chat" id="chat"></div>
<div class="options" id="options"></div>

<div class="result-screen" id="resultScreen">
    <h2>Assessment Report</h2>
    <div class="risk-label" id="riskLabel"></div>
    <div class="score" id="finalScore"></div>
    <div id="resultText"></div>
    <button class="btn download" onclick="downloadPDF()">Download Prescription</button>
    <button class="btn restart" onclick="restart()">Start Again</button>
</div>
</div>

<script>
const { jsPDF } = window.jspdf;

let patientName = "";
let current = 0;
let score = 0;
let risk = "";
let suggestion = "";

const questions = [
"Little interest or pleasure in doing things?",
"Feeling down, depressed, or hopeless?",
"Trouble sleeping?",
"Feeling tired or low energy?",
"Poor appetite or overeating?",
"Feeling bad about yourself?",
"Trouble concentrating?",
"Restlessness or moving slowly?"
];

const chat = document.getElementById("chat");
const optionsDiv = document.getElementById("options");
const resultScreen = document.getElementById("resultScreen");

function addMessage(text, sender, bold=false) {
    const msg = document.createElement("div");
    msg.classList.add("message", sender);
    msg.innerHTML = bold ? "<b>" + text + "</b>" : text;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
}

function askName() {
    addMessage("Please enter patient name:", "bot");
    optionsDiv.innerHTML = "<input id='nameInput' placeholder='Enter name'><br><button onclick='startScreening()'>Start</button>";
}

function startScreening() {
    patientName = document.getElementById("nameInput").value || "Patient";
    optionsDiv.innerHTML = "";
    addMessage("Welcome " + patientName + ".", "bot");
    addMessage("Question 1 of " + questions.length, "bot");
    addMessage(questions[0], "bot", true);
    showOptions();
}

function showOptions() {
    optionsDiv.innerHTML = "";
    ["Not at all (0)","Several days (1)","More than half (2)","Nearly every day (3)"]
    .forEach((label, i) => {
        let btn = document.createElement("button");
        btn.innerText = label;
        btn.onclick = () => selectAnswer(i,label);
        optionsDiv.appendChild(btn);
    });
}

function selectAnswer(value,label) {
    score += value;
    addMessage(label,"user");
    optionsDiv.innerHTML="";
    current++;
    if(current<questions.length){
        setTimeout(()=>{
            addMessage("Question "+(current+1)+" of "+questions.length,"bot");
            addMessage(questions[current],"bot",true);
            showOptions();
        },600);
    } else {
        setTimeout(showResult,600);
    }
}

function showResult(){
    if(score<=4){ risk="Low Risk"; suggestion="Maintain healthy lifestyle."; }
    else if(score<=9){ risk="Mild Risk"; suggestion="Monitor wellbeing."; }
    else if(score<=14){ risk="Moderate Risk"; suggestion="Consider counselling."; }
    else { risk="High Risk"; suggestion="Seek psychological counselling."; }

    let color = score<=4 ? "green" : score<=9 ? "orange" : score<=14 ? "darkorange" : "red";

    document.getElementById("riskLabel").innerText=risk;
    document.getElementById("finalScore").innerText=score;
    document.getElementById("finalScore").style.color=color;
    document.getElementById("resultText").innerHTML=
        "<b>"+suggestion+"</b><br><br>Support (India):<br>KIRAN: 1800-599-0019<br>ICALL: 9152987821<br>Emergency: 112";

    resultScreen.style.display="block";
}

function downloadPDF(){
    const doc=new jsPDF();
    doc.setFontSize(18);
    doc.text("Primary Health Centre - Mental Health Report",20,20);
    doc.setFontSize(12);
    doc.text("Patient Name: "+patientName,20,35);
    doc.text("Date: "+new Date().toLocaleDateString(),20,45);
    doc.line(20,50,190,50);

    doc.text("Assessment Score:",20,65);
    doc.setFontSize(24);
    doc.text(String(score),20,80);

    doc.setFontSize(14);
    doc.text("Risk Category: "+risk,20,100);

    doc.setFont(undefined,'bold');
    doc.text(suggestion,20,115);

    doc.setFont(undefined,'normal');
    doc.text("Support (India):",20,135);
    doc.text("KIRAN: 1800-599-0019",20,145);
    doc.text("ICALL: 9152987821",20,155);
    doc.text("Emergency: 112",20,165);

    doc.line(20,190,190,190);
    doc.text("Doctor Signature: ____________________",20,205);

    doc.save("Mental_Health_Prescription.pdf");
}

function restart(){
    current=0; score=0;
    chat.innerHTML="";
    optionsDiv.innerHTML="";
    resultScreen.style.display="none";
    askName();
}

askName();
</script>

</body>
</html>